/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/anndata/utils.py:429: FutureWarning: Importing read_csv from `anndata` is deprecated. Import anndata.io.read_csv instead.
  warnings.warn(msg, FutureWarning)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/anndata/utils.py:429: FutureWarning: Importing read_loom from `anndata` is deprecated. Import anndata.io.read_loom instead.
  warnings.warn(msg, FutureWarning)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/anndata/utils.py:429: FutureWarning: Importing read_text from `anndata` is deprecated. Import anndata.io.read_text instead.
  warnings.warn(msg, FutureWarning)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/anndata/utils.py:429: FutureWarning: Importing CSCDataset from `anndata.experimental` is deprecated. Import anndata.abc.CSCDataset instead.
  warnings.warn(msg, FutureWarning)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/anndata/utils.py:429: FutureWarning: Importing CSRDataset from `anndata.experimental` is deprecated. Import anndata.abc.CSRDataset instead.
  warnings.warn(msg, FutureWarning)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/anndata/utils.py:429: FutureWarning: Importing read_elem from `anndata.experimental` is deprecated. Import anndata.io.read_elem instead.
  warnings.warn(msg, FutureWarning)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/scvi/data/fields/_base_field.py:63: UserWarning: adata.X does not contain unnormalized count data. Are you sure this is what you want?
  self.validate_field(adata)
Anndata setup with scvi-tools version 1.2.0.

Setup via `SCVI.setup_anndata` with arguments:
{
│   'layer': None,
│   'batch_key': 'Metadata_Source',
│   'labels_key': 'Metadata_JCP2022',
│   'size_factor_key': None,
│   'categorical_covariate_keys': None,
│   'continuous_covariate_keys': None
}

         Summary Statistics         
┏━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┓
┃     Summary Stat Key     ┃ Value ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━┩
│         n_batch          │   2   │
│         n_cells          │ 11892 │
│ n_extra_categorical_covs │   0   │
│ n_extra_continuous_covs  │   0   │
│         n_labels         │  302  │
│          n_vars          │ 1014  │
└──────────────────────────┴───────┘
               Data Registry                
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Registry Key ┃    scvi-tools Location    ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│      X       │          adata.X          │
│    batch     │ adata.obs['_scvi_batch']  │
│    labels    │ adata.obs['_scvi_labels'] │
└──────────────┴───────────────────────────┘
                       batch State Registry                        
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓
┃       Source Location        ┃ Categories ┃ scvi-tools Encoding ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩
│ adata.obs['Metadata_Source'] │  source_2  │          0          │
│                              │  source_6  │          1          │
└──────────────────────────────┴────────────┴─────────────────────┘
                         labels State Registry                          
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓
┃        Source Location        ┃   Categories   ┃ scvi-tools Encoding ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩
│ adata.obs['Metadata_JCP2022'] │     AMG900     │          0          │
│                               │  Aloxistatin   │          1          │
│                               │      DMSO      │          2          │
│                               │ Dexamethasone  │          3          │
│                               │     FK-866     │          4          │
│                               │ JCP2022_000794 │          5          │
│                               │ JCP2022_001036 │          6          │
│                               │ JCP2022_001275 │          7          │
│                               │ JCP2022_001890 │          8          │
│                               │ JCP2022_002118 │          9          │
│                               │ JCP2022_002206 │         10          │
│                               │ JCP2022_003951 │         11          │
│                               │ JCP2022_004587 │         12          │
│                               │ JCP2022_004940 │         13          │
│                               │ JCP2022_005163 │         14          │
│                               │ JCP2022_005529 │         15          │
│                               │ JCP2022_005628 │         16          │
│                               │ JCP2022_006270 │         17          │
│                               │ JCP2022_007175 │         18          │
│                               │ JCP2022_007419 │         19          │
│                               │ JCP2022_007613 │         20          │
│                               │ JCP2022_009419 │         21          │
│                               │ JCP2022_009867 │         22          │
│                               │ JCP2022_009886 │         23          │
│                               │ JCP2022_010382 │         24          │
│                               │ JCP2022_010404 │         25          │
│                               │ JCP2022_010654 │         26          │
│                               │ JCP2022_011759 │         27          │
│                               │ JCP2022_012146 │         28          │
│                               │ JCP2022_012198 │         29          │
│                               │ JCP2022_013455 │         30          │
│                               │ JCP2022_013856 │         31          │
│                               │ JCP2022_014114 │         32          │
│                               │ JCP2022_014367 │         33          │
│                               │ JCP2022_015955 │         34          │
│                               │ JCP2022_016288 │         35          │
│                               │ JCP2022_016935 │         36          │
│                               │ JCP2022_017377 │         37          │
│                               │ JCP2022_017914 │         38          │
│                               │ JCP2022_018074 │         39          │
│                               │ JCP2022_018280 │         40          │
│                               │ JCP2022_018899 │         41          │
│                               │ JCP2022_019314 │         42          │
│                               │ JCP2022_020163 │         43          │
│                               │ JCP2022_020718 │         44          │
│                               │ JCP2022_021678 │         45          │
│                               │ JCP2022_021751 │         46          │
│                               │ JCP2022_021857 │         47          │
│                               │ JCP2022_022191 │         48          │
│                               │ JCP2022_022359 │         49          │
│                               │ JCP2022_023781 │         50          │
│                               │ JCP2022_024601 │         51          │
│                               │ JCP2022_024824 │         52          │
│                               │ JCP2022_026475 │         53          │
│                               │ JCP2022_027206 │         54          │
│                               │ JCP2022_027911 │         55          │
│                               │ JCP2022_028032 │         56          │
│                               │ JCP2022_028645 │         57          │
│                               │ JCP2022_028940 │         58          │
│                               │ JCP2022_029186 │         59          │
│                               │ JCP2022_029365 │         60          │
│                               │ JCP2022_029868 │         61          │
│                               │ JCP2022_029951 │         62          │
│                               │ JCP2022_030049 │         63          │
│                               │ JCP2022_030094 │         64          │
│                               │ JCP2022_030713 │         65          │
│                               │ JCP2022_030831 │         66          │
│                               │ JCP2022_031861 │         67          │
│                               │ JCP2022_032353 │         68          │
│                               │ JCP2022_032357 │         69          │
│                               │ JCP2022_032680 │         70          │
│                               │ JCP2022_032771 │         71          │
│                               │ JCP2022_033012 │         72          │
│                               │ JCP2022_033400 │         73          │
│                               │ JCP2022_033814 │         74          │
│                               │ JCP2022_033914 │         75          │
│                               │ JCP2022_033936 │         76          │
│                               │ JCP2022_034137 │         77          │
│                               │ JCP2022_034709 │         78          │
│                               │ JCP2022_035296 │         79          │
│                               │ JCP2022_035351 │         80          │
│                               │ JCP2022_035570 │         81          │
│                               │ JCP2022_036614 │         82          │
│                               │ JCP2022_038096 │         83          │
│                               │ JCP2022_038675 │         84          │
│                               │ JCP2022_039047 │         85          │
│                               │ JCP2022_039116 │         86          │
│                               │ JCP2022_039503 │         87          │
│                               │ JCP2022_039863 │         88          │
│                               │ JCP2022_041107 │         89          │
│                               │ JCP2022_041139 │         90          │
│                               │ JCP2022_041253 │         91          │
│                               │ JCP2022_042261 │         92          │
│                               │ JCP2022_042332 │         93          │
│                               │ JCP2022_042354 │         94          │
│                               │ JCP2022_042960 │         95          │
│                               │ JCP2022_043099 │         96          │
│                               │ JCP2022_043287 │         97          │
│                               │ JCP2022_043332 │         98          │
│                               │ JCP2022_043547 │         99          │
│                               │ JCP2022_044197 │         100         │
│                               │ JCP2022_044972 │         101         │
│                               │ JCP2022_045036 │         102         │
│                               │ JCP2022_045105 │         103         │
│                               │ JCP2022_046239 │         104         │
│                               │ JCP2022_046462 │         105         │
│                               │ JCP2022_046524 │         106         │
│                               │ JCP2022_046649 │         107         │
│                               │ JCP2022_047143 │         108         │
│                               │ JCP2022_047545 │         109         │
│                               │ JCP2022_047559 │         110         │
│                               │ JCP2022_048928 │         111         │
│                               │ JCP2022_048971 │         112         │
│                               │ JCP2022_049224 │         113         │
│                               │ JCP2022_050162 │         114         │
│                               │ JCP2022_050271 │         115         │
│                               │ JCP2022_050338 │         116         │
│                               │ JCP2022_050516 │         117         │
│                               │ JCP2022_050830 │         118         │
│                               │ JCP2022_050861 │         119         │
│                               │ JCP2022_050873 │         120         │
│                               │ JCP2022_050997 │         121         │
│                               │ JCP2022_051043 │         122         │
│                               │ JCP2022_051319 │         123         │
│                               │ JCP2022_051415 │         124         │
│                               │ JCP2022_052259 │         125         │
│                               │ JCP2022_052804 │         126         │
│                               │ JCP2022_052870 │         127         │
│                               │ JCP2022_053409 │         128         │
│                               │ JCP2022_053626 │         129         │
│                               │ JCP2022_053734 │         130         │
│                               │ JCP2022_054601 │         131         │
│                               │ JCP2022_054618 │         132         │
│                               │ JCP2022_055397 │         133         │
│                               │ JCP2022_055904 │         134         │
│                               │ JCP2022_056401 │         135         │
│                               │ JCP2022_056730 │         136         │
│                               │ JCP2022_057163 │         137         │
│                               │ JCP2022_057881 │         138         │
│                               │ JCP2022_057971 │         139         │
│                               │ JCP2022_058046 │         140         │
│                               │ JCP2022_058288 │         141         │
│                               │ JCP2022_058461 │         142         │
│                               │ JCP2022_058889 │         143         │
│                               │ JCP2022_059103 │         144         │
│                               │ JCP2022_059269 │         145         │
│                               │ JCP2022_059825 │         146         │
│                               │ JCP2022_059966 │         147         │
│                               │ JCP2022_060040 │         148         │
│                               │ JCP2022_060311 │         149         │
│                               │ JCP2022_060649 │         150         │
│                               │ JCP2022_060734 │         151         │
│                               │ JCP2022_061421 │         152         │
│                               │ JCP2022_061437 │         153         │
│                               │ JCP2022_061654 │         154         │
│                               │ JCP2022_062023 │         155         │
│                               │ JCP2022_062184 │         156         │
│                               │ JCP2022_062326 │         157         │
│                               │ JCP2022_062592 │         158         │
│                               │ JCP2022_063174 │         159         │
│                               │ JCP2022_064183 │         160         │
│                               │ JCP2022_064903 │         161         │
│                               │ JCP2022_065525 │         162         │
│                               │ JCP2022_066287 │         163         │
│                               │ JCP2022_067426 │         164         │
│                               │ JCP2022_067432 │         165         │
│                               │ JCP2022_067441 │         166         │
│                               │ JCP2022_067886 │         167         │
│                               │ JCP2022_067887 │         168         │
│                               │ JCP2022_068238 │         169         │
│                               │ JCP2022_068606 │         170         │
│                               │ JCP2022_068634 │         171         │
│                               │ JCP2022_068660 │         172         │
│                               │ JCP2022_068713 │         173         │
│                               │ JCP2022_068838 │         174         │
│                               │ JCP2022_068901 │         175         │
│                               │ JCP2022_069131 │         176         │
│                               │ JCP2022_069285 │         177         │
│                               │ JCP2022_069491 │         178         │
│                               │ JCP2022_069668 │         179         │
│                               │ JCP2022_069672 │         180         │
│                               │ JCP2022_071429 │         181         │
│                               │ JCP2022_071733 │         182         │
│                               │ JCP2022_071811 │         183         │
│                               │ JCP2022_071910 │         184         │
│                               │ JCP2022_072945 │         185         │
│                               │ JCP2022_073156 │         186         │
│                               │ JCP2022_073458 │         187         │
│                               │ JCP2022_073628 │         188         │
│                               │ JCP2022_074697 │         189         │
│                               │ JCP2022_074702 │         190         │
│                               │ JCP2022_075182 │         191         │
│                               │ JCP2022_075694 │         192         │
│                               │ JCP2022_075916 │         193         │
│                               │ JCP2022_075930 │         194         │
│                               │ JCP2022_076233 │         195         │
│                               │ JCP2022_076300 │         196         │
│                               │ JCP2022_076523 │         197         │
│                               │ JCP2022_076573 │         198         │
│                               │ JCP2022_077046 │         199         │
│                               │ JCP2022_077089 │         200         │
│                               │ JCP2022_077096 │         201         │
│                               │ JCP2022_077142 │         202         │
│                               │ JCP2022_077671 │         203         │
│                               │ JCP2022_077927 │         204         │
│                               │ JCP2022_078581 │         205         │
│                               │ JCP2022_078588 │         206         │
│                               │ JCP2022_079562 │         207         │
│                               │ JCP2022_079617 │         208         │
│                               │ JCP2022_079715 │         209         │
│                               │ JCP2022_080150 │         210         │
│                               │ JCP2022_080224 │         211         │
│                               │ JCP2022_080920 │         212         │
│                               │ JCP2022_081430 │         213         │
│                               │ JCP2022_081496 │         214         │
│                               │ JCP2022_081555 │         215         │
│                               │ JCP2022_082046 │         216         │
│                               │ JCP2022_082234 │         217         │
│                               │ JCP2022_083099 │         218         │
│                               │ JCP2022_083372 │         219         │
│                               │ JCP2022_084364 │         220         │
│                               │ JCP2022_084606 │         221         │
│                               │ JCP2022_084963 │         222         │
│                               │ JCP2022_085892 │         223         │
│                               │ JCP2022_086505 │         224         │
│                               │ JCP2022_087444 │         225         │
│                               │ JCP2022_087474 │         226         │
│                               │ JCP2022_087562 │         227         │
│                               │ JCP2022_087693 │         228         │
│                               │ JCP2022_088224 │         229         │
│                               │ JCP2022_088849 │         230         │
│                               │ JCP2022_089172 │         231         │
│                               │ JCP2022_089383 │         232         │
│                               │ JCP2022_090051 │         233         │
│                               │ JCP2022_090205 │         234         │
│                               │ JCP2022_090768 │         235         │
│                               │ JCP2022_090884 │         236         │
│                               │ JCP2022_091373 │         237         │
│                               │ JCP2022_092256 │         238         │
│                               │ JCP2022_092464 │         239         │
│                               │ JCP2022_093047 │         240         │
│                               │ JCP2022_093289 │         241         │
│                               │ JCP2022_093480 │         242         │
│                               │ JCP2022_093678 │         243         │
│                               │ JCP2022_093901 │         244         │
│                               │ JCP2022_093956 │         245         │
│                               │ JCP2022_094002 │         246         │
│                               │ JCP2022_096054 │         247         │
│                               │ JCP2022_096067 │         248         │
│                               │ JCP2022_096342 │         249         │
│                               │ JCP2022_096865 │         250         │
│                               │ JCP2022_097564 │         251         │
│                               │ JCP2022_097998 │         252         │
│                               │ JCP2022_098688 │         253         │
│                               │ JCP2022_099089 │         254         │
│                               │ JCP2022_099471 │         255         │
│                               │ JCP2022_100264 │         256         │
│                               │ JCP2022_100688 │         257         │
│                               │ JCP2022_100876 │         258         │
│                               │ JCP2022_101857 │         259         │
│                               │ JCP2022_101929 │         260         │
│                               │ JCP2022_102083 │         261         │
│                               │ JCP2022_102917 │         262         │
│                               │ JCP2022_102936 │         263         │
│                               │ JCP2022_103217 │         264         │
│                               │ JCP2022_103291 │         265         │
│                               │ JCP2022_104437 │         266         │
│                               │ JCP2022_104794 │         267         │
│                               │ JCP2022_105442 │         268         │
│                               │ JCP2022_105456 │         269         │
│                               │ JCP2022_105539 │         270         │
│                               │ JCP2022_105621 │         271         │
│                               │ JCP2022_105696 │         272         │
│                               │ JCP2022_106219 │         273         │
│                               │ JCP2022_106680 │         274         │
│                               │ JCP2022_106722 │         275         │
│                               │ JCP2022_106781 │         276         │
│                               │ JCP2022_107658 │         277         │
│                               │ JCP2022_108326 │         278         │
│                               │ JCP2022_109043 │         279         │
│                               │ JCP2022_109350 │         280         │
│                               │ JCP2022_109917 │         281         │
│                               │ JCP2022_110929 │         282         │
│                               │ JCP2022_111730 │         283         │
│                               │ JCP2022_112702 │         284         │
│                               │ JCP2022_112828 │         285         │
│                               │ JCP2022_113600 │         286         │
│                               │ JCP2022_113710 │         287         │
│                               │ JCP2022_113779 │         288         │
│                               │ JCP2022_114322 │         289         │
│                               │ JCP2022_114461 │         290         │
│                               │ JCP2022_115049 │         291         │
│                               │ JCP2022_115134 │         292         │
│                               │ JCP2022_115963 │         293         │
│                               │ JCP2022_116188 │         294         │
│                               │ JCP2022_116437 │         295         │
│                               │ JCP2022_116560 │         296         │
│                               │ JCP2022_116749 │         297         │
│                               │   LY2109761    │         298         │
│                               │   NVS-PAK1-1   │         299         │
│                               │   Quinidine    │         300         │
│                               │   TC-S-7004    │         301         │
└───────────────────────────────┴────────────────┴─────────────────────┘
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA H100 80GB HBM3') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Training:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 1/2:   0%|          | 0/2 [00:00<?, ?it/s]/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/scvi/module/_vae.py:565: UserWarning: The value argument must be within the support of the distribution
  reconst_loss = -generative_outputs[MODULE_KEYS.PX_KEY].log_prob(x).sum(-1)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/scvi/module/_vae.py:565: UserWarning: The value argument must be within the support of the distribution
  reconst_loss = -generative_outputs[MODULE_KEYS.PX_KEY].log_prob(x).sum(-1)
Epoch 1/2:  50%|█████     | 1/2 [00:28<00:28, 28.53s/it]Epoch 1/2:  50%|█████     | 1/2 [00:28<00:28, 28.53s/it, v_num=1, train_loss_step=2.6e+3, train_loss_epoch=2.83e+3]Epoch 2/2:  50%|█████     | 1/2 [00:28<00:28, 28.53s/it, v_num=1, train_loss_step=2.6e+3, train_loss_epoch=2.83e+3]/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/scvi/module/_vae.py:565: UserWarning: The value argument must be within the support of the distribution
  reconst_loss = -generative_outputs[MODULE_KEYS.PX_KEY].log_prob(x).sum(-1)
/ictstr01/home/icb/mahima.arunkumar/hiwi/env_store/9794f96f55a968753fa448ae0a3a3f7e_/lib/python3.11/site-packages/scvi/module/_vae.py:565: UserWarning: The value argument must be within the support of the distribution
  reconst_loss = -generative_outputs[MODULE_KEYS.PX_KEY].log_prob(x).sum(-1)
Epoch 2/2: 100%|██████████| 2/2 [00:29<00:00, 12.26s/it, v_num=1, train_loss_step=2.6e+3, train_loss_epoch=2.83e+3]Epoch 2/2: 100%|██████████| 2/2 [00:29<00:00, 12.26s/it, v_num=1, train_loss_step=2.53e+3, train_loss_epoch=2.56e+3]`Trainer.fit` stopped: `max_epochs=2` reached.
Epoch 2/2: 100%|██████████| 2/2 [00:29<00:00, 14.70s/it, v_num=1, train_loss_step=2.53e+3, train_loss_epoch=2.56e+3]
